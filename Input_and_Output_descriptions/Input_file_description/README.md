## Input data
- The input files 

```
# list all input files
>>> cd /Path_to_Interspec-EpiState-NMF/input_files/
>>> ls
IDEAS.EpigeneticState.mean_signal_mat.txt
config.info.txt
S3V2_IDEAS_hg38_r3_withHg38Mm10prior.state.matched_ct.bed
S3V2_IDEAS_mm10_r3_withHg38Mm10prior.state.matched_ct.bed
hg38.gene.bed
mm10.gene.bed
```

- The `config.info.txt` includes all parameters used for the Interspec-EpiState-NMF pipeline. The details about the parameters in the `config.info.txt` file can be found [Here](https://raw.githubusercontent.com/guanjue/public_log_descriptions/main/Interspec-EpiState-NMF/parameter.details.md):
```
>>> cat /Path_to_Interspec-EpiState-NMF/input_files/config.info.txt
script_dir	/Users/guanjuexiang/Documents/projects/git/Interspec-EpiState-NMF/scripts/
working_dir	/Users/guanjuexiang/Documents/projects/analysis/test_cormat_NMF_FDR_pipeline_GATA1_Gata1/
#
hg38_gene	GATA1
mm10_gene	Gata1
hg38_gene_set	/Users/guanjuexiang/Documents/projects/git/Interspec-EpiState-NMF/input_files/hg38.gene.bed
mm10_gene_set	/Users/guanjuexiang/Documents/projects/git/Interspec-EpiState-NMF/input_files/mm10.gene.bed
hg38_gene_exp_win_u	50000
hg38_gene_exp_win_d	50000
mm10_gene_exp_win_u	50000
mm10_gene_exp_win_d	50000
#
hg38_state_set	/Users/guanjuexiang/Documents/projects/git/Interspec-EpiState-NMF/input_files/S3V2_IDEAS_hg38_r3_withHg38Mm10prior.state.matched_ct.bed
mm10_state_set	/Users/guanjuexiang/Documents/projects/git/Interspec-EpiState-NMF/input_files/S3V2_IDEAS_mm10_r3_withHg38Mm10prior.state.matched_ct.bed
EpigeneticState_meansignal_mat_file	/Users/guanjuexiang/Documents/projects/git/Interspec-EpiState-NMF/input_files/IDEAS.EpigeneticState.mean_signal_mat.txt
#
random_background_gene_num	100
fdr_threshold	0.1
NMF_component_num	6
```

- Due to the file size (~700 MB), the two epigenetic state bed files: `S3V2_IDEAS_hg38_r3_withHg38Mm10prior.state.matched_ct.bed` and `S3V2_IDEAS_mm10_r3_withHg38Mm10prior.state.matched_ct.bed` need to be generated by using the `Interspec-EpiState-NMF/scripts/get_IDEAS_epigenetic_state_file.sh` script. 
```
>>> # BED file containing data on Human epigenetic states across various cell types
>>> head /Path_to_Interspec-EpiState-NMF/input_files/S3V2_IDEAS_hg38_r3_withHg38Mm10prior.state.matched_ct.bed
CHR	POSst	POSed	AVE	B_B15_50	B_NC14_42	CMP_100246	ERY_S002R5	ERY_S002S3	GMP_100256	HSC_100258	MEP_Donor2596	MK_S004BTH2	MK_S00VHKH1	MONc_C0011IH1	NK_S005YG	T_CD4_S008H1	T_CD8_C0066PH1
chr1	792600	792800	0	0	0	0	0	0	0	0	0	0	0	0	0
chr1	792800	793000	0	0	0	0	0	0	0	0	0	0	0	0	0
chr1	793000	793200	0	0	0	0	0	0	0	0	0	0	0	0	0
chr1	793200	793400	0	0	0	0	0	0	0	0	0	0	0	0	0
chr1	793400	793600	0	0	0	0	0	0	0	0	0	0	0	0	0
chr1	793600	793800	0	0	0	0	0	0	0	0	0	0	0	0	0
chr1	793800	794000	0	0	0	0	0	0	0	0	0	0	0	0	0
chr1	794000	794200	0	0	0	0	0	0	0	0	0	0	0	0	0
chr1	794200	794400	0	0	2	0	0	0	0	0	0	2	0	0	2
```
```
>>> # BED file containing data on Mouse epigenetic states across various cell types
>>> head /Path_to_Interspec-EpiState-NMF/input_files/S3V2_IDEAS_mm10_r3_withHg38Mm10prior.state.matched_ct.bed
CHR	POSst	POSed	AVE	B_r1	B_r2	CMP_r1	ERY_ad_r1	ERY_ad_r2	GMP_r1	LSK_r1	MEP_r1	MK_fl_r1	MK_fl_r2	MON_r1	NK_r1	T_CD4_r1	T_CD8_r1
chr1	0	200	0	0	0	0	0	0	0	0	0	0	0	0	0
chr1	200	400	0	0	0	0	0	0	0	0	0	0	0	0	0
chr1	400	600	0	0	0	0	0	0	0	0	0	0	0	0	0
chr1	600	800	0	0	0	0	0	0	0	0	0	0	0	0	0
chr1	800	1000	0	0	0	0	0	0	0	0	0	0	0	0	0
chr1	1000	1200	0	0	0	0	0	0	0	0	0	0	0	0	0
chr1	1200	1400	0	0	0	0	0	0	0	0	0	0	0	0	0
chr1	1400	1600	0	0	0	0	0	0	0	0	0	0	0	0	0
chr1	1600	1800	0	0	0	0	0	0	0	0	0	0	0	0	0
```

- The `IDEAS.EpigeneticState.mean_signal_mat.txt` includes the means signal of different epigenetic features in each of the epigenetic state. Each row is an epigenetic state and each column is an epigenetic feature. The column is separated by tab. 
```
>>> head /Path_to_Interspec-EpiState-NMF/input_files/IDEAS.EpigeneticState.mean_signal_mat.txt 
ATAC	CTCF	H3K27ac	H3K27me3	H3K4me1	H3K4me3	H3K36me3	H3K9me3
0.2225	0.30854	0.24859	0.44813	0.17075	0.35091	0.135	0.23436
0.24005	0.38888	0.28872	0.53194	0.19509	0.45276	0.15683	1.0859
0.28611	0.34652	0.36004	0.34278	0.24866	0.37487	1.45896	0.1964
0.29813	0.34396	0.26703	1.82927	0.26062	0.42872	0.14263	0.27335
0.40779	0.36126	0.49415	0.38723	2.0368	0.50614	0.23358	0.18091
1.63288	0.30789	0.32032	0.46298	0.45218	0.39363	0.22286	0.2234
0.61117	0.34906	1.1059	0.39896	4.92565	1.06885	0.2659	0.17169
0.22206	0.29521	0.25457	0.69578	0.19641	0.5047	0.23887	4.90405
0.64573	0.39855	0.68925	0.38318	1.23973	0.50632	3.24877	0.19854
```

- The `hg38.gene.bed` and `mm10.gene.bed` include the coordinates of the Human and Mouse genes. 
```
>>> # Human genes in hg38 genome
>>> head input_files/hg38.gene.bed 
chr1	65419	71585	+	OR4F5
chr1	450740	451678	-	OR4F29
chr1	685716	686654	-	OR4F16
chr1	923923	944575	+	SAMD11
chr1	944203	959309	-	NOC2L
chr1	960584	965719	+	KLHL17
chr1	966482	975865	+	PLEKHN1
chr1	975204	982093	-	PERM1
chr1	998962	1000172	-	HES4
chr1	1001138	1014540	+	ISG15
```
```
>>> # Mouse genes in mm10 genome
>>> head input_files/mm10.gene.bed 
chr1	3205901	3671498	-	Xkr4
chr1	3999557	4409241	-	Rp1
chr1	4490931	4497354	-	Sox17
chr1	4773206	4785739	-	Mrpl15
chr1	4807788	4848410	+	Lypla1
chr1	4807892	4886770	+	Gm37988
chr1	4857814	4897909	+	Tcea1
chr1	4909576	5070285	-	Rgs20
chr1	5070018	5162529	+	Atp6v1h
chr1	5588466	5606131	+	Oprk1
```
